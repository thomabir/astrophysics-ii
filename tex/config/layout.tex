% -------------------------
% GEOMETRY
% -------------------------


% For printing on A4
\usepackage[includemp,
            a4paper,
            layoutwidth=18.90cm,
            layoutheight=24.58cm,
            layouthoffset=1.05cm,
            layoutvoffset=2.56cm,
            ]{geometry}

% old
% \newgeometry{includemp,
%             top=2.170cm,
%             bottom=3.510cm,
%             inner=1.668cm,
%             outer=1cm,
%             marginparwidth=5.699cm, % Fixed for now
%             marginparsep=0.4cm}

% new
\newgeometry{
  a4paper,
  bottom=27.4mm,
  inner=24.8mm,
  textwidth=115mm,
  marginparsep=8.2mm,
  marginparwidth=49.4mm,
  includemp
  }%
\savegeometry{with-margin}




\newgeometry{ignoremp,
            top=2.170cm,
            bottom=3.510cm,
            inner=1.668cm,
            outer=2.699cm}
\savegeometry{no-margin}



\usepackage{floatrow}  % Set up captions of floats
\usepackage{marginfix} % Make marginpars float freely
\usepackage{sidenotes} % Footnotes as sidenotes

% WHY IS CHANGING THE FONT SIZE OF SIDENOTES SO COMPLICATED? THIS IS WHY LATEX IS HORRIBLE.
\makeatletter
\RenewDocumentCommand\sidenotetext{oo+m}{%
  \IfValueTF{#1}{%
    \@sidenotes@placemarginal{#2}{\footnotesize\textsuperscript{#1}\footnotesize~#3}
  }{%
    \@sidenotes@placemarginal{#2}{\footnotesize\textsuperscript{\thesidenote}{}\footnotesize~#3}%
    \refstepcounter{sidenote}%
  }%
}
\makeatother



% Figures and tables
\floatsetup[figure]{margins=hangoutside,
                    facing=yes,
                    capposition=beside,
                    capbesideposition={center,outside},
                    floatwidth=\textwidth}
\floatsetup[widefigure]{margins=hangoutside,
                        facing=yes,
                        capposition=bottom}
\floatsetup[table]{margins=hangoutside,
                   facing=yes,
                   capposition=beside,
                   capbesideposition={center,outside},
                   floatwidth=\textwidth}
\floatsetup[widetable]{margins=hangoutside,
                       facing=yes,
                       capposition=bottom}



% Figure captions with no indentation
\setcapindent{0pt}

